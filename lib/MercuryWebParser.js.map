{"version":3,"sources":["../source/MercuryWebParser.js"],"names":["MercuryWebParser","key","undefined","Error","message","service","url","headers","response","ok","ErrorServerResponse","status","statusText","fail","json","data","pages","length","page","next_page_url","get","push"],"mappings":";;;;;;;AAAA;;AACA;;;;;;;;;;;;;;;;AAEA;;;;;;;;IAQqBA,gB;;;AACnB;;;;AAIA,4BAAYC,GAAZ,EAAiB;AAAA;;AACf,QAAIA,QAAQC,SAAZ,EAAuB,MAAM,IAAIC,KAAJ,CAAUH,iBAAiBI,OAAjB,CAAyBH,GAAnC,CAAN;AACvB,SAAKI,OAAL,GAAe,sCAAf;AACA,SAAKJ,GAAL,GAAWA,GAAX;AACD;AAED;;;;;;;;;AASA;;;;;;;;;;;;;;+CAWUK,G;;;;;;;uBACe,wCAAS,KAAKD,OAAd,kBAA6BC,GAA7B,GAAoC;AACzDC,2BAAS;AACP,oCAAgB,kBADT;AAEP,iCAAa,KAAKN;AAFX;AADgD,iBAApC,C;;;AAAjBO,wB;;oBAMDA,SAASC,E;;;;;sBACN,IAAIC,4BAAJ,CACJF,SAASG,MADL,EAEJH,SAASI,UAFL,EAGJZ,iBAAiBI,OAAjB,CAAyBS,IAHrB,C;;;;uBAKWL,SAASM,IAAT,E;;;AAAbC,oB;iDACCA,I;;;;;;;;;;;;;;AAGT;;;;;;;;;;;;;;;;;gDAWaT,G;;;;;;AACLU,qB,GAAQ,E;;;sBAEPA,MAAMC,MAAN,KAAiB,CAAjB,IAAsBC,KAAKC,aAAL,KAAuB,I;;;;;;uBACrC,KAAKC,GAAL,CAASd,GAAT,C;;;AAAbY,oB;AACAF,sBAAMK,IAAN,CAAWH,IAAX;;;;;kDAEKF,K;;;;;;;;;;;;;;AAGT;;;;;;;;;AASA;;;;;;;;;;;;;;;;;;;;;;;;;;;;gBA9EmBhB,gB,aAeF;AACfC,OAAK,kBADU;AAEfY,QAAM;AAFS,C","sourcesContent":["import fetch from 'isomorphic-fetch';\nimport ErrorServerResponse from './ErrorServerResponse';\n\n/**\n * SDK for mercury api\n *\n * @namespace MercuryWebParser\n * @class\n * @param {string} key - mercury api key\n * @see https://mercury.postlight.com/web-parser/\n */\nexport default class MercuryWebParser {\n  /**\n   * Constructor, save mercury api key\n   * @param {string} key - mercury api key\n   */\n  constructor(key) {\n    if (key === undefined) throw new Error(MercuryWebParser.message.key);\n    this.service = 'https://mercury.postlight.com/parser';\n    this.key = key;\n  }\n\n  /**\n   * Messages of mercury SDK\n   * @type {Object}\n   */\n  static message = {\n    key: 'You need API key',\n    fail: 'Failed fetching page',\n  };\n\n  /**\n   * Get content of page\n   * @param  {string} url - page url\n   * @return {Promise.<Page>} - single page\n   *\n   * @example <caption>Get single page</caption>\n   * (async () => {\n   *   const parser = new MercuryWebParser('NeBIXVwRCXVIS3lJC74dsRAMBOaIK6H5EEkFudvs');\n   *   const page = await parser.get('http://alistapart.com/article/design-like-a-teacher');\n   * })();\n   */\n  async get(url) {\n    const response = await fetch(`${this.service}?url=${url}`, {\n      headers: {\n        'Content-Type': 'application/json',\n        'x-api-key': this.key,\n      },\n    });\n    if (!response.ok)\n      throw new ErrorServerResponse(\n        response.status,\n        response.statusText,\n        MercuryWebParser.message.fail,\n      );\n    const data = await response.json();\n    return data;\n  }\n\n  /**\n   * Get content of page\n   * @param  {string} url - page url\n   * @return {Promise.<PagesList>} - array of pages\n   *\n   * @example <caption>Get all pages as array</caption>\n   * (async () => {\n   *   const parser = new MercuryWebParser('NeBIXVwRCXVIS3lJC74dsRAMBOaIK6H5EEkFudvs');\n   *   const pages = await parser.getAll('http://alistapart.com/article/design-like-a-teacher');\n   * })();\n   */\n  async getAll(url) {\n    const pages = [];\n    let page;\n    while (pages.length === 0 || page.next_page_url !== null) {\n      page = await this.get(url);\n      pages.push(page);\n    }\n    return pages;\n  }\n\n  /**\n   * Pages list array\n   *\n   * @namespace MercuryWebParser\n   * @typedef {PagesList} Array of pages\n   *\n   * @property {Array.<Page>} - array of pages\n   */\n\n  /**\n   * Page object\n   *\n   * @namespace MercuryWebParser\n   * @typedef {Page} Page representation\n   *\n   * @property {string} title - page title\n   * @property {string} content - page content\n   * @property {string} date_published - page publication timestamp\n   * @property {string} lead_image_url - lead image url\n   * @property {string} dek - ?\n   * @property {string} url - url of the current page\n   * @property {string} domain - page domain\n   * @property {string} excerpt - ?\n   * @property {number} word_count - count of the words on the page\n   * @property {string} direction - ltr or rtl text direction\n   * @property {number} total_pages - total pages count\n   * @property {number} rendered_pages - ?\n   * @property {string | null} next_page_url - next page url if available or null if there are none\n   */\n}\n"],"file":"MercuryWebParser.js"}